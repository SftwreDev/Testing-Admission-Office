{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block content %}
<style>
table.dataTable thead .sorting:after,
table.dataTable thead .sorting:before,
table.dataTable thead .sorting_asc:after,
table.dataTable thead .sorting_asc:before,
table.dataTable thead .sorting_asc_disabled:after,
table.dataTable thead .sorting_asc_disabled:before,
table.dataTable thead .sorting_desc:after,
table.dataTable thead .sorting_desc:before,
table.dataTable thead .sorting_desc_disabled:after,
table.dataTable thead .sorting_desc_disabled:before {
bottom: .5em;
}

</style>
<div class="container-fluid">
  {% for message in messages %}
  <div class="alert alert-primary alert-dismissible fade show" role="alert">
    {{message}}
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  {% endfor %}
  <div class="card shadow mb-3" style="font-size: 12px;">
    <div class="card-header">Search</div>
    <div class="p-3">
      <form method="GET">
        {% csrf_token %}
        <div class="row">
            <div class="col-sm-3 col-md-3 col-lg-3">
              {{filter_qs.form.l_name|as_crispy_field}}
            </div>
            <div class="col-sm-3 col-md-3 col-lg-3">
              {{filter_qs.form.f_name|as_crispy_field}}
            </div>
            <div class="col-sm-3 col-md-3 col-lg-3">
              {{filter_qs.form.m_name|as_crispy_field}}
            </div>
            <div class="col-sm-3 col-md-3 col-lg-3"> 
              <input class="btn btn-primary btn-sm" type="submit" value="Search" style="margin-top: 2rem;">
            </div>
        </div>

      
        <div class="row">
            <div class="col-sm-2 col-md-2 col-lg-2">
              {{filter_qs.form.major|as_crispy_field}}
            </div>
            <div class="col-sm-2 col-md-2 col-lg-2">
              {{filter_qs.form.college|as_crispy_field}}
            </div>
            <div class="col-sm-2 col-md-2 col-lg-2">
              {{filter_qs.form.course|as_crispy_field}}
            </div>
            <div class="col-sm-4 col-md-4 col-lg-2"> 
              {{filter_qs.form.yearlevel|as_crispy_field}}
              
            </div>
            <div class="col-sm-2 col-md-2 col-lg-2"> 
              <input class="btn btn-primary btn-sm" type="submit" value="Filter" style="margin-top: 2rem;">
            </div>
        </div>

      </form> 
    </div>
  </div>
    
  
  <div class="card shadow">
    <div class="card-header">
      <div class="row">
        
        <div class="col-sm-4">
         List of Students &nbsp; 
         <a href="" data-toggle="modal" data-target="#addModal"><i class="fas fa-user-plus"></i></a>
        
        </div>
        <div class="col-sm-8 text-end">
          <a href="{% url 'students:export_students' %}" class="btn btn-primary btn-sm">Export</a>
        </div>
      </div>
    </div>
    
    <div class="card-body">
      <table id="dtVerticalScrollExample" class="table table-striped table-borderless table-hover table-sm text-center" cellspacing="0"
      width="100%" style="font-size: 13px;">
        <thead>
          <tr>
              <th></th>
              <th>Full Name</th>
              <th>College</th>
              <th>Course</th>
              <th>Major</th>
              <th>Year Level</th>
              <th>Actions</th>
          </tr>
      </thead>
      {% for list in filter_qs.qs %}
      <tbody>
          <tr>
            <th>{{forloop.counter}}</th>
            <td>{{list.l_name}}, {{ list.f_name }} {{ list.m_name }}</td>
            <td>{{list.college}}</td>
            <td>{{list.course}}</td>
            <td>{{list.major}}</td>
            <td>{{list.yearlevel}}</td>
            <td>
              <a href="{% url 'students:students_detail_view' list.pk %}" class="btn btn-primary btn-sm"><i class="fas fa-eye"></i></a>
              <a href="" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#deleteModal"><i class="fas fa-trash-alt"></i></a>
            </td>
          </tr>
      </tbody>
      
        <!-- Modal -->
        <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog ">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Confirmation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
            
              <div class="modal-body">
              Are you sure you want to delete this data ?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <a href="{% url 'students:delete_students' list.pk %}" class="btn btn-primary">Yes</a>
              </div>
            
            </div>
          </div>
        </div>
      {% endfor %}
      </table>
    </div>
  </div>

  
</div>

<!-- Modal -->
<div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog ">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add new student</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form method = "POST">
      <div class="modal-body">
        {% csrf_token %}
        {{student_form|crispy}}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-primary">Save</button>
      </div>
      </form>
    </div>
  </div>
</div>



<script>
  $(document).ready(function () {
$('#dtVerticalScrollExample').DataTable({
"scrollY": "200px",
"scrollCollapse": true,
});
$('.dataTables_length').addClass('bs-select');
});
</script>
{% endblock content  %}



